---
typora-root-url: ./
---

# 机器学习大作业报告

软73 沈冠霖 2017013569

## 1.运行方法

#### 1.1 开发环境：

- python==3.7.1
- numpy==1.19.1
- pandas==1.1.0
- matplotlib==3.3.0
- seaborn==0.11.0
- scikit_learn==0.23.2

#### 1.2 运行方法

代码在src/AdaBoost文件夹下，需要到这里运行。

首先安装依赖：

```shell
pip install -r requirements.txt
```

运行主函数（特征选择方法为3.1提到的方法）：

```shell
python main.py 
```

运行grid search

```shell
python grid_search.py
```

复现最优结果

```shell
python grid_search.py --best=1
```



## 2.算法选择

因为这个问题是一个二分类问题，而且数据很多都是离散的值（比如对对方的评价为1-10间的整数），因此考虑采用决策树类模型。因为AdaBoost的表达能力较强，而且不容易过拟合（训练样本只有几千条），因此选择这个算法。



## 3.特征选择

首先，我们考虑，约会对象的编号、组号等数据显然对解决问题毫无帮助，就把这些数据去除。

之后，我们尝试选出一些特征进行分析：

#### 3.1 根据相关性筛选特征

首先，我们计算了所有特征和结果的相关性，把相关性的绝对值大于等于0.1的特征留了下来。同时，为了防止过拟合，我们去除了缺失值过多的特征以防止过拟合，同时将有缺失值的特征用其众数替代。相关性可视化结果如下：

![corr](/corr.png)

这样做能只保留17组特征，特征简化的很多了，而且达到了88.61%的训练准确率和86.14%的测试准确率，初步说明这样做有道理。

#### 3.2 根据语义选择特征

根据上方的相关性分析，我们发现，attr_o/attr等特征和结果相关性较高，而且这些特征反映的是第一次约会后双方对对方的评价，能够反映双方的互相喜欢程度，我们称这些特征为组1。我们发现，这个数据集里还有其他能够反映双方对对方评价的特征：约会后一天填写的问卷；约会后3-4周填写的问卷，我们记这些特征为组2，组3。将特征组1、2、3进行组合，就能得到7种特征组合。经过grid search，在最优网络超参数下，他们的训练测试准确率如下：

|            | 1      | 2      | 3      | 1+2    | 1+3        | 2+3    | 1+2+3  |        |
| ---------- | ------ | ------ | ------ | ------ | ---------- | ------ | ------ | ------ |
| 训练准确率 | 86.88% | 83.64% | 83.63% | 87.47% | 87.4%      | 83.63% | 87.51% | 86.77% |
| 测试准确率 | 89.11% | 75.25% | 75.25% | 85.15% | **93.07%** | 75.25% | 87.13% | 88.12% |

 可以看出，特征1是最基础的特征，必须含有特征1模型才能很好运行。而特征1加上特征3能够更好改进模型效果。因此，我们选择使用特征1+特征3的组合作为最终特征，得到93.07%的结果。

## 4.总结

93.07%的准确率在排行榜上是很不错的成绩了，排名第3（这个竞赛的测试数据集有失误，结果match这一列可以直接用dec和dec_o做且运算做出来。。。所以排名靠前的准确率都是1，这显然是不合理的，我们没有用这两个特征，第3是刨除准确率为1的队伍后的结果）。这次作业，也让我了解到了用机器学习方法进行数据分析的基本流程。

- 首先，要分析数据特征，根据特征选择合适的算法。比如分类问题选用决策树类算法（决策树，随机森林，adaboost）和逻辑回归较好，回归问题用线性模型、回归树等较好。
- 其次，要根据数据挑选出特征。可以用求相关性的方法得到一些特征，也可以根据语义构造出特征。
- 之后，要进行数据清洗，比如很多特征有缺失值，可以用众数填充，缺失太多的特征。容易过拟合，要扔掉。
- 最后，可以用grid search的方法，比较不同模型/网络超参数/特征选择的情况，找到最优的那个模型

总结一下，就是最关键的不是算法本身（sklearn和pandas封装的很好），是**算法选择、数据处理、特征选择**。